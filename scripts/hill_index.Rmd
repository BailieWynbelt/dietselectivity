---
title: "Hill Index"
author: "Bailie Wynbelt"
date: "18-04-2023"
output: github_document
---
read packages
```{r}
library(tidyverse)
install.packages('SpadeR')
library(SpadeR)
```

read data
```{r}
ITS2 <- read_csv("../outputs/no_millet_vouchers_ITS2.csv")

trnL <- read_csv("../outputs/no_millet_vouchers_trnL.csv")
```

10 cutoff 
```{r}
#automatically removes NA's
ITS2 <- ITS2 %>% 
  filter(Reads >= 10) %>% 
  select(SampleID, Genus, Reads)

trnL <- trnL %>% 
  filter(Reads >= 10) %>% 
  select(SampleID, Genus, Reads)

ITS2 <- ITS2 %>% 
  group_by(SampleID, Genus) %>% 
  summarise(Reads = sum(Reads))

trnL <- trnL %>% 
  group_by(SampleID, Genus) %>% 
  summarise(Reads = sum(Reads))

```

shift data frame
```{r}
ITS2_wide <- ITS2 %>% 
  pivot_wider(names_from = Genus, values_from = Reads) %>% 
  column_to_rownames("SampleID")
    
ITS2_wide <- ITS2_wide %>% 
  replace(is.na(.), 0)

ITS2_wide_2 <- as.matrix(ITS2_wide)
```

Hill Index - Spade
```{r}
hill_ITS2 <- Diversity(ITS2_wide_2, datatype = c("abundance"), q = NULL)
hill_ITS2 <- iNEXT(ITS2_wide_2, datatype = c("abundance"), q = 1)
```

```{r}

```

Hill Index - ITS2
```{r}
#calculates taxonomic diversity for each site (alpha diversity)
#can we consider each sampleID as a unique site, compairson??
# q = 0 (default hill number - can change to get shannon or simpson)
hill_taxa(ITS2, q = 0, MARGIN = 1, base = exp(1))
```

Hill Index - trnL
```{r}
#calculates taxonomic diversity for each site (alpha diversity)
#can we consider each sampleID as a unique site, compairson??
# q = 0 (default hill number - can change to get shannon or simpson)
hill_taxa(trnL, q = 0, MARGIN = 1, base = exp(1))
```
